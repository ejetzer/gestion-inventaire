#!/usr/bin/env python3# -*- coding: utf-8 -*-"""Inscrire des gens à la formation simdut.Created on Thu Mar  3 11:22:01 2022@author: emilejetzer"""import timefrom pathlib import Pathimport schedulefrom ...outils.reseau.msforms import MSFormConfig, MSFormfrom ...outils.reseau import OneDrivefrom ...outils.reseau.courriel import Courrielclass SSTSIMDUTInscriptionConfig(MSFormConfig):    def default(self):        return (Path(__file__).parent / 'inscription.cfg').open().read()class SSTSIMDUTInscriptionForm(MSForm):        def nettoyer(self, cadre):        cadre = self.convertir_champs(cadre)        return cadre.loc[:, ['date', 'Nom', 'Prénom', 'Courriel',                             'Matricule', 'Département', 'Langue',                             'Statut', 'Professeur ou supérieur immédiat']]        def action(self, cadre):        if not cadre.empty():            fichier_temp = Path('nouvelles_entrées.xlsx')            cadre.to_excel(fichier_temp)                        message = 'Bonjour! Voici les nouvelles inscriptions à faire pour le SIMDUT. Bonne journée!'            html = f'<p>{message}</p>{cadre.to_html()}'                        courriel = Courriel(self.config.get('courriel', 'destinataire'),                                self.config.get('courriel', 'expéditeur'),                                self.config.get('courriel', 'objet'),                                message,                                html,                                pièces_jointes=[fichier_temp])            courriel.envoyer(self.config.get('courriel', 'serveur'))def main():    chemin_config = next(Path(__file__).parent.glob('*.cfg'))    config = SSTSIMDUTInscriptionConfig(chemin_config)        dossier = OneDrive('',                       config.get('onedrive', 'organisation'),                       config.get('onedrive', 'sous-dossier'),                       partagé=True)    fichier = dossier / config.get('formulaire', 'nom')    config.set('formulaire', 'chemin', str(fichier))        formulaire = SSTSIMDUTInscriptionForm(config)        schedule.every().monday.at('09:00').do(formulaire.mise_à_jour)        while True:        schedule.run_pending()        time.sleep(1)if __name__ == '__main__':    main()